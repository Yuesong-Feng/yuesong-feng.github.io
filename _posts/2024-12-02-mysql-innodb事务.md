---
layout: post
title: MySQL InnoDB事务
date: 2024-12-02 21:55 +0800
author: yuesong-feng
category:
- 数据库内核
- MySQL
tags:
- mysql
---
## 事务
事务是数据库操作中的一个重要概念，它可以将一系列数据库操作作为一个不可分割的工作单元，并保证这些操作要么全部执行成功，要么全部失败回滚。事务具有ACID属性，是保证数据一致性和可靠性的重要手段。

## 事务的ACID属性
- 原子性：Atomicity，整个数据库事务是不可分割的工作单位
- 一致性：Consistency，事务将数据库从一种状态转变为下一种一致的状态
- 隔离性：Isolation，每个读写事务的对象对其他事务的操作对象能相互分离
- 持久性：Durability，事务一旦提交，其结果是永久性的

## 事务隔离级别
- 读未提交
- 读已提交
- 可重复读
- 可串行化

## InnoDB事务实现
InnoDB通过redo log(重做日志)和undo log(回滚日志)来实现事务的原子性、一致性和持久性，redo log用于记录事务对数据库的修改操作，undo log用于记录事务的回滚信息。通过MVCC(多版本并发控制)来实现事务的隔离性，MVCC通过为每个事务创建一个独立的数据库视图，来避免读写冲突和脏读等并发问题。

InnoDB日志采用WAL(write-ahead-logging)方式，即在事务提交之前必须先将修改操作记录到日志中。

InnoDB事务有三种基本操作：启动、提交、回滚

事务的启动是指当一个新的事务开始时，Innodb需要进行一系列的准备工作，包括分配事务ID、创建事务日志、设置数据库视图等。

事务的提交是指当一个事务执行完毕，需要将事务的修改操作持久化到磁盘，并释放相关的资源。Innodb通过事务日志和redo log来实现事务的提交。

事务的回滚是指当一个事务执行失败或被取消时，需要撤销事务的修改操作，并释放相关的资源。Innodb通过事务日志和undo log来实现事务的回滚。
